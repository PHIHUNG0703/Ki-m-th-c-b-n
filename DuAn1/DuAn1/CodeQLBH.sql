USE QLBH
GO
INSERT INTO NHANVIEN(MANV,TENNV,SDT,EMAIL,MATKHAU,DIACHI,NGAYSINH,GIOITINH,VAITRO,HINH) values 
('nv01','Vo Khanh Toan','076389837','toanvkpc05433@fpt.edu.vn','123','Can Tho','07-01-2004',1,1,'avt1.jpg'),
('nv02','Phan Minh Sang','084377234','sangpmpc05409@fpt.edu.vn','123','Binh Duong','02-02-2004',1,0,'avt2.jpg')
GO
INSERT INTO KHACHHANG(MAKH,TENKH, SDT,DIACHI,GHICHU) values 
('kh01','Ha  Thanh Nhe','02174832835','Binh Duong','Khach Quen'),
('kh02','Tran Quoc Thinh','02174832835','Ha Tien','Khach Quen')
GO
INSERT INTO NHACUNGCAP(MANCC,TENNCC, DIACHI,SDT,EMAIL) values 
('ncc01','ace cook','binh duong','0123456789','acecook@gmail.com'),
('ncc02','masan','da nang','0123456789','masan@gmail.com'),
('ncc03','heineken','da nang','0123456789','heineken@gmail.com'),
('ncc04','cty tnhh red bull','da nang','0123456789','redbull@gmail.com')
GO
INSERT INTO LOAISANPHAM(MALOAI,TENLOAI) values 
('lsp01','mi'),
('lsp02','bia'),
('lsp03','nuoc tang luc')
GO
INSERT INTO SANPHAM(MASP,TENSP, MALOAI,GIABAN,SOLUONG,DVTINH,MANCC,GHICHU,HINH,PTGIAMGIA,TIENGIAMGIA,TONGTIEN) values 
('sp01','mi hao han','lsp01','125000','1','thung','ncc01','ban chay','mihaohao.png','10','12500','11250'),
('sp02','mi doraemon','lsp01','124000','1','thung','ncc01','ban chay','midoraemon.png','0','0','12400'),
('sp03','mi tien vua','lsp01','105000','1','thung','ncc02','ban chay','mitienvua.png','20','21000','84000'),
('sp04','bia tiger','lsp02','17900','1','lon','ncc02','ban chay','biatiger.png','0','0','17900'),
('sp05','red bull','lsp03','10800','1','lon','ncc04','ban chay','redbull.png','0','0','10800'),
('sp06','strong bow','lsp02','20500','1','lon','ncc02','ban chay','strongbow.png','0','0','20500')
GO
INSERT INTO PHIEUNHAP(MAPN,NGAYNHAP,MANCC,MANV) VALUES
('pn01','2023-11-24','ncc01','nv01')
GO
INSERT INTO PHIEUNHAPCT(MAPNCT,MAPN,MASP,MALOAI,DONGIANHAP,SOLUONG,DVTINH,TONGTIEN) VALUES
('pnct01','pn01','sp01','lsp01','125000','1','thung','125000')
GO
INSERT INTO HOADON(MANV,MAKH,TONGTIEN) VALUES
('nv01','kh01','0'),
('nv01','kh02','0')
GO
DELETE FROM HOADON WHERE MANV LIKE 'nv01'
DELETE FROM HOADONCT WHERE MAHD like '2'
INSERT INTO HOADONCT(MASP,MALOAI,GIABAN,SOLUONG,DVTINH,PTGIAMGIA,TIENGIAMGIA,TONGTIEN,MAHD) VALUES
('sp01','lsp01','125000','1','thung','0','0','125000','3')
INSERT INTO HOADONCT(MASP,MALOAI,GIABAN,SOLUONG,DVTINH,PTGIAMGIA,TIENGIAMGIA,TONGTIEN,MAHD) VALUES
('sp06','lsp02','20500','1','lon','0','0','20500','4'),
('sp05','lsp02','20500','10','lon','0','0','20500','4')
SELECT MASP, TENSP, A.MALOAI ,B.TENLOAI, SOLUONG, GIABAN, DVTINH, A.MANCC ,C.TENNCC, GHICHU, HINH, PTGIAMGIA, TIENGIAMGIA, TONGTIEN
FROM SANPHAM A
INNER JOIN LOAISANPHAM B ON A.MALOAI = B.MALOAI
INNER JOIN NHACUNGCAP C ON A.MANCC = C.MANCC

SELECT A.MAHDCT, A.MASP, B.TENSP, A.MALOAI, C.TENLOAI, A.GIABAN, A.SOLUONG, A.DVTINH, A.PTGIAMGIA, A.TIENGIAMGIA, A.TONGTIEN, MAHD FROM HOADONCT A INNER JOIN SANPHAM B ON A.MASP = B.MASP INNER JOIN LOAISANPHAM C ON A.MALOAI = C.MALOAI


SELECT MASP, TENSP,B.TENLOAI,SOLUONG,GIABAN,DVTINH,C.TENNCC,GHICHU,HINH 
FROM SANPHAM A
INNER JOIN LOAISANPHAM B ON A.MALOAI = B.MALOAI
INNER JOIN NHACUNGCAP C ON A.MANCC = C.MANCC
WHERE TENSP LIKE 'mi hao han'

SELECT MASP, TENSP,B.TENLOAI,SOLUONG,GIABAN,DVTINH,C.TENNCC,GHICHU,HINH 
FROM SANPHAM A
INNER JOIN LOAISANPHAM B ON A.MALOAI = B.MALOAI
INNER JOIN NHACUNGCAP C ON A.MANCC = C.MANCC

SELECT MALOAI FROM LOAISANPHAM WHERE TENLOAI like 'bia'

SELECT MAPNCT, B.MAPN, B.NGAYNHAP, B.MANCC, C.TENNCC, B.MANV, D.TENNV, A.MASP, E.TENSP, A.MALOAI, F.TENLOAI, DONGIANHAP,A.SOLUONG,A.DVTINH,A.TONGTIEN
FROM PHIEUNHAPCT A
INNER JOIN PHIEUNHAP B ON A.MAPN = B.MAPN
INNER JOIN NHACUNGCAP C ON B.MANCC = C.MANCC
INNER JOIN NHANVIEN D ON B.MANV = D.MANV
INNER JOIN SANPHAM E ON A.MASP = E.MASP
INNER JOIN LOAISANPHAM F ON E.MALOAI = F.MALOAI

SELECT A.MAHD ,A.MANV, C.TENNV, A.MAKH, D.TENKH, NGAYBAN,A.TONGTIEN 
FROM HOADON A 
INNER JOIN NHANVIEN C ON A.MANV = C.MANV 
INNER JOIN KHACHHANG D ON A.MAKH = D.MAKH
ORDER BY NGAYBAN DESC

DELETE FROM SANPHAM WHERE MASP = 'sp06'

SELECT TENLOAI FROM LOAISANPHAM WHERE TENLOAI like '%i%'

SELECT A.MAHD ,A.MANV, C.TENNV, A.MAKH, D.TENKH,A.TONGTIEN
FROM HOADON A 
INNER JOIN NHANVIEN C ON A.MANV = C.MANV
INNER JOIN KHACHHANG D ON A.MAKH = D.MAKH

SELECT A.MAHDCT, A.MASP, B.TENSP, A.MALOAI, C.TENLOAI, A.GIABAN, A.SOLUONG, A.DVTINH, A.PTGIAMGIA, A.TIENGIAMGIA, A.TONGTIEN, MAHD
FROM HOADONCT A
INNER JOIN SANPHAM B ON A.MASP = B.MASP
INNER JOIN LOAISANPHAM C ON A.MALOAI = C.MALOAI
WHERE MAHD LIKE 'hd02'

SELECT MALOAI, GIABAN, SOLUONG,DVTINH,PTGIAMGIA,TIENGIAMGIA,TONGTIEN FROM SANPHAM

SELECT MAHDCT FROM HOADONCT A INNER JOIN SANPHAM B ON A.MASP = B.MASP WHERE TENSP LIKE 'mi tien vua'

SELECT * FROM HOADONCT 
SELECT * FROM HOADON

SELECT SUM(TONGTIEN) AS TongGia FROM HOADONCT WHERE MAHD = 'hd01';

delete from HOADONCT where MAHD = '3'

SELECT A.SOLUONG FROM HOADONCT A INNER JOIN SANPHAM B ON A.MASP = B.MASP WHERE TENSP LIKE 'mi hao han'
SELECT COUNT(*) FROM HOADONCT A INNER JOIN SANPHAM B ON A.MASP = B.MASP WHERE TENSP LIKE 'mi hao han'
SELECT SUM(TONGTIEN) FROM HOADONCT WHERE MAHD like 'hd01'

SELECT C.TENSP,B.NGAYBAN,A.GIABAN,A.SOLUONG,A.PTGIAMGIA,A.TIENGIAMGIA,A.TONGTIEN FROM HOADONCT A INNER JOIN HOADON B ON A.MAHD = B.MAHD INNER JOIN SANPHAM C ON A.MASP = C.MASP ORDER BY B.NGAYBAN DESC

SELECT MASP,TENSP,A.MALOAI,B.TENLOAI,GIABAN,DVTINH,PTGIAMGIA,TIENGIAMGIA FROM SANPHAM A INNER JOIN LOAISANPHAM B ON A.MALOAI = B.MALOAI WHERE TENSP LIKE 'mi hao han'

CREATE PROC sp_soLuongBanRa
AS BEGIN
	SELECT 
		c.TENSP as tenSP,
		b.NGAYBAN as ngayBan,
		a.GIABAN as giaBan,
		a.SOLUONG as soLuong,
		a.PTGIAMGIA as ptGiamGia,
		a.TIENGIAMGIA as tienGiamGia,
		a.TONGTIEN as tongTien
		FROM HOADONCT A
		inner join HOADON B on a.MAHD = b.MAHD
		inner join SANPHAM C on a.MASP = c.MASP
		ORDER BY b.NGAYBAN Desc
   END
drop proc sp_soLuongBanRa

SELECT C.TENSP ,B.NGAYBAN,A.GIABAN,A.SOLUONG,A.PTGIAMGIA,A.TIENGIAMGIA,A.TONGTIEN 
FROM HOADONCT A
INNER JOIN HOADON B ON A.MAHD = B.MAHD 
INNER JOIN SANPHAM C ON A.MASP = C.MASP 
WHERE B.NGAYBAN >= '2023-01-03' AND B.NGAYBAN <= '2023-01-29'

select top 5 A.MASP, A.TENSP, SUM(C.TONGTIEN) as "TONGTIEN"
from SANPHAM A 
INNER JOIN HOADONCT B ON A.MASP = B.MASP
INNER JOIN HOADON C ON B.MAHD = C.MAHD
group by A.MASP, A.TENSP 
order by 'TONGTIEN' desc

SELECT MASP,TENSP, A.MALOAI,B.TENLOAI,GIABAN,SOLUONG,DVTINH,PTGIAMGIA,TIENGIAMGIA,TONGTIEN
FROM SANPHAM A 
INNER JOIN LOAISANPHAM B ON A.MALOAI = B.MALOAI 
WHERE TENSP LIKE 'mi hao han'